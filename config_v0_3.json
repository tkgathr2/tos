{
  "config_version": "v0.3",
  "sprint": "S-5",
  "s5_settings": {
    "enabled": true,
    "description": "S-5 experimental features"
  },
  "openai_model": "gpt-4o-mini",
  "anthropic_model": "claude-3-haiku-20240307",
  "max_steps": 8,
  "api_retry": 2,
  "json_retry": 2,
  "timeout_sec": 120,
  "workspace_dir": "workspace",
  "logs_dir": "logs",
  "execution_policy": {
    "default_action": "allow",
    "stop_on_deny": true,
    "deny_if_contains": [
      "Remove-Item",
      "rmdir",
      "del ",
      "format ",
      "shutdown",
      "reg add"
    ]
  },
  "allow_types": ["powershell"],
  "deny_patterns": [
    "Remove-Item.*-Recurse",
    "rmdir.*/s",
    "del.*/f",
    "format ",
    "shutdown",
    "reg add",
    "reg delete",
    "sc create",
    "sc delete",
    "net user",
    "net localgroup",
    "Invoke-WebRequest",
    "Invoke-RestMethod",
    "curl ",
    "wget ",
    "Start-Process",
    "Set-ExecutionPolicy",
    "New-Service",
    "Stop-Service",
    "Remove-Service"
  ],
  "draft_prompt_template": "あなたはタスク実行AIです。以下の目標を達成するためのコマンドを生成してください。\n\n目標: workspace/results/result_v2.txt に集計結果を出力する\n条件:\n- result_v2.txt には「合計:」「平均:」「件数:」の3つのキーワードを含めること\n- PowerShellコマンドで実行可能な形式で出力すること\n- ファイル出力には Set-Content を使用すること（Out-File は使わない）\n- エンコーディングは UTF8 を指定すること\n\nステップ: {step_num}\nこれまでの履歴: {history_json}\n\n以下のJSON形式のみで応答してください。説明文は不要です。\n{\n  \"thought\": \"この行動の理由\",\n  \"commands\": [\n    {\n      \"type\": \"powershell\",\n      \"code\": \"実行するPowerShellコード\"\n    }\n  ]\n}",
  "review_prompt_template": "あなたはコードレビュアーです。以下のドラフトをレビューし、改善してください。\n\nドラフト:\n{draft_json}\n\nステップ: {step_num}\n\nレビュー観点:\n1. コマンドが安全か（危険なコマンドがないか）\n2. 目標を達成できるか\n3. ファイル出力には Set-Content -Encoding UTF8 を使うこと（Out-File は使わない）\n\n以下のJSON形式のみで応答してください。説明文は不要です。\n{\n  \"review\": \"レビューコメント\",\n  \"improved_commands\": [\n    {\n      \"type\": \"powershell\",\n      \"code\": \"改善後のコード\"\n    }\n  ],\n  \"approval\": true\n}",
  "final_prompt_template": "あなたは最終判断AIです。ドラフトとレビューを踏まえて、実行する最終コマンドを決定してください。\n\nドラフト:\n{draft_json}\n\nレビュー:\n{review_json}\n\nステップ: {step_num}\n\n以下のJSON形式のみで応答してください。説明文は不要です。\n{\n  \"final_commands\": [\n    {\n      \"type\": \"powershell\",\n      \"code\": \"最終的に実行するコード\"\n    }\n  ],\n  \"summary\": \"このステップで行ったことの要約\"\n}"
}
